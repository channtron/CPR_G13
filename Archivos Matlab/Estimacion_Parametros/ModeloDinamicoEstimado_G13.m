function [qdd] = ModeloDinamicoEstimado_G13(in)

% Variables de entrada en la funcion: [q(2)  qp(2)  Imotor(2)]
q1        = in(1);
q2        = in(2);
q3        = in(3);
qd1       = in(4);
qd2       = in(5);
qd3       = in(6);
Im1      = in(7);
Im2      = in(8);
Im3      = in(9);

% Factores de reducción
  % R1=50; R2=30; R3=15;
  R1=1; R2=1; R3=1; %Accionamiento directo
  
% K
  K=diag([0.5,0.4,0.35]); %(N*m/A)
  g=9.81;

%CON ACCIONAMIENTO DIRECTO R=1
% Matriz de Inercias
  M =[(37484704943901605*cos(2*q2 + q3))/18014398509481984 + (198511777824469863*cos(2*q2))/72057594037927936 + (2845292342181915821*cos(2*q2 + 2*q3))/4611686018427387904 + (37484704943901605*cos(q3))/18014398509481984 + 15649490943052737411/4611686018427387904,  0,    0;
      0,  (37484704943901605*cos(q3))/9007199254740992 + 61191177716690857/9007199254740992, (37484704943901605*cos(q3))/18014398509481984 + 11128271780502267/9007199254740992;
       0, (37484704943901605*cos(q3))/18014398509481984 + 11128271780502267/9007199254740992,      (439273883879913*R3^2)/18014398509481984 + 11128271780502267/9007199254740992];
 
% Matriz de aceleraciones centrípetas y de Coriolis
  V=[-(qd1*(- 27670116110557964*R1^2 + 12704753780766071232*qd2*sin(2*q2) + 2845292342181915821*qd2*sin(2*q2 + 2*q3) + 2845292342181915821*qd3*sin(2*q2 + 2*q3) + 4798042232819405440*qd3*sin(q3) + 9596084465638810880*qd2*sin(2*q2 + q3) + 4798042232819405440*qd3*sin(2*q2 + q3)))/2305843009213693952;
    (37484704943901605*qd1^2*sin(2*q2 + q3))/18014398509481984 - (37484704943901605*qd3^2*sin(q3))/18014398509481984 + (198511777824469863*qd1^2*sin(2*q2))/72057594037927936 + (4899916394579519*R2^2*qd2)/576460752303423488 + (2845292342181915821*qd1^2*sin(2*q2 + 2*q3))/4611686018427387904 - (37484704943901605*qd2*qd3*sin(q3))/9007199254740992;
    (37484704943901605*qd1^2*sin(q3))/36028797018963968 + (37484704943901605*qd2^2*sin(q3))/18014398509481984 + (37484704943901605*qd1^2*sin(2*q2 + q3))/36028797018963968 + (3*R3^2*qd3)/200 + (2845292342181915821*qd1^2*sin(2*q2 + 2*q3))/4611686018427387904];
 
  
% Par gravitatorio                
  G = [  0;
        g*((37484704943901605*cos(q2 + q3))/18014398509481984 + (57476547580649119*cos(q2))/9007199254740992);
       (37484704943901605*g*cos(q2 + q3))/18014398509481984];
 
                                              
% Ecuación del robot
%    Tau = M*qpp + V + G
  Im=[Im1;Im2;Im3];
  Tau=[Im1*R1*K(1,1);Im2*R2*K(2,2);Im3*R3*K(3,3)];
% Por lo que:  
% Aceleraciones
  qdd = inv(M)*(Tau-V-G);