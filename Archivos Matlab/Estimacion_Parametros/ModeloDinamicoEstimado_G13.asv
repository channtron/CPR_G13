function [qdd] = ModeloDinamicoEstimado_G13(in)

% Variables de entrada en la funcion: [q(2)  qp(2)  Imotor(2)]
q1        = in(1);
q2        = in(2);
q3        = in(3);
qd1       = in(4);
qd2       = in(5);
qd3       = in(6);
Im1      = in(7);
Im2      = in(8);
Im3      = in(9);

% Factores de reducción
  % R1=50; R2=30; R3=15;
  R1=1; R2=1; R3=1; %Accionamiento directo
  
% K
  K=diag([0.5,0.4,0.35]); %(N*m/A)
  g=9.8;

%CON ACCIONAMIENTO DIRECTO R=1
% Matriz de Inercias
  M =[(18779354963576153*cos(2*q2 + q3))/9007199254740992 + (795600186984910767*cos(2*q2))/288230376151711744 + (5701769916613896479*cos(2*q2 + 2*q3))/9223372036854775808 + (18779354963576153*cos(q3))/9007199254740992 + 31360264815594338465/9223372036854775808,                                                                                   0,                                                                                  0;
                                                                                                                                                                                                                                                              0, (18779354963576153*cos(q3))/4503599627370496 + 245246820203527381/36028797018963968, (18779354963576153*cos(q3))/9007199254740992 + 44594519591210925/36028797018963968;
                                                                                                                                                                                                                                                              0,  (18779354963576153*cos(q3))/9007199254740992 + 44594519591210925/36028797018963968,   (3518620813618063*R3^2)/144115188075855872 + 44594519591210925/36028797018963968];
 
% Matriz de aceleraciones centrípetas y de Coriolis
  V=[-(qd1*(- 55787867842183384*R1^2 + 25459205983517144544*qd2*sin(2*q2) + 5701769916613896479*qd2*sin(2*q2 + 2*q3) + 5701769916613896479*qd3*sin(2*q2 + 2*q3) + 9615029741350990336*qd3*sin(q3) + 19230059482701980672*qd2*sin(2*q2 + q3) + 9615029741350990336*qd3*sin(2*q2 + q3)))/4611686018427387904;
 (18779354963576153*qd1^2*sin(2*q2 + q3))/9007199254740992 - (18779354963576153*qd3^2*sin(q3))/9007199254740992 + (795600186984910767*qd1^2*sin(2*q2))/288230376151711744 + (1223353988135879*R2^2*qd2)/144115188075855872 + (5701769916613896479*qd1^2*sin(2*q2 + 2*q3))/9223372036854775808 - (18779354963576153*qd2*qd3*sin(q3))/4503599627370496;
                                                           (18779354963576153*qd1^2*sin(q3))/18014398509481984 + (18779354963576153*qd2^2*sin(q3))/9007199254740992 + (18779354963576153*qd1^2*sin(2*q2 + q3))/18014398509481984 + (4305959798902987*R3^2*qd3)/288230376151711744 + (5701769916613896479*qd1^2*sin(2*q2 + 2*q3))/9223372036854775808];
 
  
% Par gravitatorio                
  G = [     0
 g*((18779354963576153*cos(q2 + q3))/9007199254740992 + (57663347410483671*cos(q2))/9007199254740992)
                                                  (18779354963576153*g*cos(q2 + q3))/9007199254740992
 
% Ecuación del robot
%    Tau = M*qpp + V + G
  Im=[Im1;Im2;Im3];
  Tau=[Im1*R1*K(1,1);Im2*R2*K(2,2);Im3*R3*K(3,3)];
% Por lo que:  
% Aceleraciones
  qdd = inv(M)*(Tau-V-G);