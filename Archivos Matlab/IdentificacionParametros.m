  
clear all;
syms T1 T2 T3 q1 qd1 qdd1 q2 qd2 qdd2 q3 qd3 qdd3 g real
PI = sym('pi');
syms m1 m2 m3 lc1 lc2 lc3 Ixx1 Ixx2 Ixx3 Iyy1 Iyy2 Iyy3 Izz1 Izz2 Izz3 Jm1 Jm2 Jm3 Bm1 Bm2 Bm3 real


Sigma=[Iyy1;Jm1;Bm1;m2;m2*lc2;m2*lc2^2;Ixx2;Iyy2;Izz2;Jm2;Bm2;...
    m3;m3*lc3;m3*lc3^2;Ixx3;Iyy3;Izz3;Jm3;Bm3];
  
% 
% aux1=[p_m11, p_m1a1, p_m1aa1, p_Ixx11, p_Iyy11, p_Izz11, p_Jm11, p_Bm11,...
%     p_m21, p_m2a1, p_m2aa1, p_Ixx21, p_Iyy21, p_Izz21, p_Jm21, p_Bm21,...
%     p_m31, p_m3a1, p_m3aa1, p_Ixx31, p_Iyy31, p_Izz31, p_Jm31, p_Bm31];
%     
% aux2=[p_m12, p_m1a2, p_m1aa2, p_Ixx12, p_Iyy12, p_Izz12, p_Jm12, p_Bm12,...
%     p_m22, p_m2a2, p_m2aa2, p_Ixx22, p_Iyy22, p_Izz22, p_Jm22, p_Bm22,...
%     p_m32, p_m3a2, p_m3aa2, p_Ixx32, p_Iyy32, p_Izz32, p_Jm32, p_Bm32];
% 
% aux3=[p_m13, p_m1a3, p_m1aa3, p_Ixx13, p_Iyy13, p_Izz13, p_Jm13, p_Bm13,...
%     p_m23, p_m2a3, p_m2aa3, p_Ixx23, p_Iyy23, p_Izz23, p_Jm23, p_Bm23,...
%     p_m33, p_m3a3, p_m3aa3, p_Ixx33, p_Iyy33, p_Izz33, p_Jm33, p_Bm33];
% simplify(aux1); simplify(aux2); simplify(aux3); 
% 
% Gamma=[aux1;aux2;aux3];
% 
% Gamma=simplify(Gamma);

Gamma= [  qdd1, 2500*qdd1, 2500*qd1, 0.5*qdd1 + 0.5*qdd1*cos(2.0*q2) - 1.0*qd1*qd2*sin(2.0*q2), 2.0*qd1*qd2*sin(2.0*q2) - 1.0*qdd1*cos(2.0*q2) - 1.0*qdd1, (qdd1*(1.0*cos(2.0*q2) + 1.0))/2 - 1.0*qd1*qd2*sin(2.0*q2), qdd1/2 - 0.5*qdd1*cos(2.0*q2) + qd1*qd2*sin(2.0*q2), 0.5*qdd1 + 0.5*qdd1*cos(2.0*q2) - 1.0*qd1*qd2*sin(2.0*q2),    0,        0,       0, 0.78125*qdd1 + 0.75*qdd1*cos(2.0*q2 + q3) + 0.28125*qdd1*cos(2*q2 + 2*q3) + 0.5*qdd1*cos(2.0*q2) + 0.75*qdd1*cos(q3) - 0.75*qd1*qd3*sin(q3) - 1.5*qd1*qd2*sin(2.0*q2 + q3) - 0.75*qd1*qd3*sin(2.0*q2 + q3) - 0.5625*qd1*qd2*sin(2*q2 + 2*q3) - 0.5625*qd1*qd3*sin(2*q2 + 2*q3) - 1.0*qd1*qd2*sin(2.0*q2), qd1*qd3*sin(q3) - 1.0*qdd1*cos(2.0*q2 + q3) - 0.75*qdd1*cos(2*q2 + 2*q3) - 1.0*qdd1*cos(q3) - 0.75*qdd1 + 2.0*qd1*qd2*sin(2.0*q2 + q3) + qd1*qd3*sin(2.0*q2 + q3) + 1.5*qd1*qd2*sin(2*q2 + 2*q3) + 1.5*qd1*qd3*sin(2*q2 + 2*q3), 0.5*qdd1 + 0.5*qdd1*cos(2*q2 + 2*q3) - 1.0*qd1*qd2*sin(2*q2 + 2*q3) - 1.0*qd1*qd3*sin(2*q2 + 2*q3), qdd1/2 - 0.5*qdd1*cos(2*q2 + 2*q3) + qd1*qd2*sin(2*q2 + 2*q3) + qd1*qd3*sin(2*q2 + 2*q3), 0.5*qdd1 + 0.5*qdd1*cos(2*q2 + 2*q3) - 1.0*qd1*qd2*sin(2*q2 + 2*q3) - 1.0*qd1*qd3*sin(2*q2 + 2*q3),           0,        0,       0;...
             0,         0,        0,                  0.5*sin(2.0*q2)*qd1^2 + qdd2 + g*cos(q2),            - 1.0*sin(2.0*q2)*qd1^2 - 2.0*qdd2 - g*cos(q2),                               0.5*sin(2.0*q2)*qd1^2 + qdd2,                              -0.5*qd1^2*sin(2.0*q2),                                     0.5*qd1^2*sin(2.0*q2), qdd2, 900*qdd2, 900*qd2,                                                                     1.5625*qdd2 + 0.5625*qdd3 - 0.75*qd3^2*sin(q3) + 0.75*g*cos(q2 + q3) + 0.75*qd1^2*sin(2.0*q2 + q3) + g*cos(q2) + 0.28125*qd1^2*sin(2*q2 + 2*q3) + 1.5*qdd2*cos(q3) + 0.75*qdd3*cos(q3) + 0.5*qd1^2*sin(2.0*q2) - 1.5*qd2*qd3*sin(q3),                                                 qd3^2*sin(q3) - 1.5*qdd3 - 1.5*qdd2 - 1.0*g*cos(q2 + q3) - 1.0*qd1^2*sin(2.0*q2 + q3) - 0.75*qd1^2*sin(2*q2 + 2*q3) - 2.0*qdd2*cos(q3) - 1.0*qdd3*cos(q3) + 2.0*qd2*qd3*sin(q3),                                                           0.5*sin(2*q2 + 2*q3)*qd1^2 + qdd2 + qdd3,                                                              -0.5*qd1^2*sin(2*q2 + 2*q3),                                                                         0.5*qd1^2*sin(2*q2 + 2*q3), qdd2 + qdd3,        0,       0;...
             0,         0,        0,                                                         0,                                                         0,                                                          0,                                                   0,                                                         0,    0,        0,       0,                                                                                                                           0.5625*qdd2 + 0.5625*qdd3 + 0.375*qd1^2*sin(q3) + 0.75*qd2^2*sin(q3) + 0.75*g*cos(q2 + q3) + 0.375*qd1^2*sin(2.0*q2 + q3) + 0.28125*qd1^2*sin(2*q2 + 2*q3) + 0.75*qdd2*cos(q3),                                                                - 1.5*qdd2 - 1.5*qdd3 - 0.5*qd1^2*sin(q3) - 1.0*qd2^2*sin(q3) - 1.0*g*cos(q2 + q3) - 0.5*qd1^2*sin(2.0*q2 + q3) - 0.75*qd1^2*sin(2*q2 + 2*q3) - 1.0*qdd2*cos(q3),                                                           0.5*sin(2*q2 + 2*q3)*qd1^2 + qdd2 + qdd3,                                                              -0.5*qd1^2*sin(2*q2 + 2*q3),                                                                         0.5*qd1^2*sin(2*q2 + 2*q3), qdd2 + qdd3, 225*qdd3, 225*qd3];

clear Gamma_numerica;
  for ind=1:3:19
    qdd1=rand; qdd2=rand; qdd3=rand; qd1=rand; qd2=rand; qd3=rand; q1=rand; q2=rand; q3=rand; g=9.81;
    Gamma_numerica(ind:ind+2,:)=eval(Gamma);
  end
  clear T1 T2 T3 q1 qd1 qdd1 q2 qd2 qdd2 q3 qd3 qdd3 g
  syms T1 T2 T3 q1 qd1 qdd1 q2 qd2 qdd2 q3 qd3 qdd3 g real


  % Gamma_numerica=Gamma_numerica_aux(1:19,:);
   size(Gamma_numerica);

  rank(Gamma_numerica);
  %Primero ejecutamos la orden rref con números para ver que columnas son
  %independientes
  %Col: 1 3 4 5 7 11 12 13 15 18 19
  [AA,ColumnasIndep]=rref(Gamma_numerica)
  
  %Ejecutamos la orden en simbolico para ver los coeficientes que
  %multiplican a Sigma
  %rref(Gamma);
%   AA=[ 1, 2500, (2500*qd1)/qdd1, 0, -(2*g*cos(q2)^2*(qdd1*cos(q2) - 2*qd1*qd2*sin(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), (2*g*cos(q2)^2*(qdd1*cos(q2) - 2*qd1*qd2*sin(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), (2*qdd1*qdd2 + 2*g*qdd1*cos(q2) - 2*g*qdd1*cos(q2)^3 - 2*qdd1*qdd2*cos(q2)^2 + qd1^2*qdd1*sin(2*q2) + 4*g*qd1*qd2*(sin(q2) - sin(q2)^3) + 2*qd1*qd2*qdd2*sin(2*q2))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), (2*cos(q2)*(qdd1*cos(q2) - 2*qd1*qd2*sin(q2))*(qdd2 + g*cos(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), -(qdd2*(qdd1 + qdd1*cos(2*q2) - 2*qd1*qd2*sin(2*q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), -(900*qdd2*(qdd1 + qdd1*cos(2*q2) - 2*qd1*qd2*sin(2*q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), -(900*qd2*(qdd1 + qdd1*cos(2*q2) - 2*qd1*qd2*sin(2*q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))), 0, -(3*(2*qdd1*qdd2^2*cos(2*q2 - q3) + 2*qdd1*qdd3^2*cos(2*q2 - q3) + 2*qdd1*qdd2^2*cos(2*q2 + 3*q3) + 3*g^2*qdd1*cos(q3) + 4*qdd1*qdd3^2*cos(q3) + 3*g^2*qdd1*cos(2*q2 + q3) - 4*qdd1*qdd2^2*cos(2*q2 + q3) + 2*qdd1*qdd3^2*cos(2*q2 + q3) + g^2*qdd1*cos(2*q2 + 3*q3) + g^2*qdd1*cos(4*q2 + 3*q3) + 3*g*qdd1*qdd2*cos(3*q2 + 3*q3) - g*qd1^3*qd3*cos(q2 - q3) + 2*g*qd1*qd2^3*cos(q2 + 3*q3) - 2*g*qd1*qd2^3*cos(3*q2 + q3) - g*qd1^3*qd3*cos(q2 + 3*q3) + g*qd1^3*qd3*cos(3*q2 + q3) + 4*qdd1*qdd2*qdd3*cos(2*q2 - q3) - 8*qd1*qd2^3*qdd2*cos(2*q2 + q3) - 4*qd1^3*qd2*qdd2*cos(2*q2 + q3) - 4*qd1*qd2^3*qdd3*cos(2*q2 + q3) - 2*qd1^3*qd2*qdd3*cos(2*q2 + q3) - 2*qd1^3*qd3*qdd2*cos(2*q2 + q3) - 2*qd1^3*qd3*qdd3*cos(2*q2 + q3) - qd1^3*qd2*qdd3*cos(4*q2 + q3) - qd1^3*qd3*qdd2*cos(4*q2 + q3) - 2*qd1^3*qd3*qdd3*cos(4*q2 + q3) - 2*g^2*qd1*qd2*sin(2*q2 + q3) - 2*g^2*qd1*qd3*sin(2*q2 + q3) + 2*g*qd1^2*qdd1*sin(q2 - q3) - 2*g*qd2^2*qdd1*sin(q2 - q3) - g*qd1^2*qdd1*sin(q2 + 3*q3) + g*qd1^2*qdd1*sin(3*q2 + q3) + g*qd2^2*qdd1*sin(q2 + 3*q3) - g*qd2^2*qdd1*sin(3*q2 + q3) + 8*qd1*qd2*qdd2^2*sin(2*q2 + q3) - 4*qd1*qd2*qdd3^2*sin(2*q2 + q3) + 4*qd1*qd3*qdd2^2*sin(2*q2 + q3) - 4*qd2^2*qdd1*qdd2*sin(2*q2 + q3) - 2*qd2^2*qdd1*qdd3*sin(2*q2 + q3) - 2*qd3^2*qdd1*qdd2*sin(2*q2 + q3) - (qd1^2*qdd1*qdd3*sin(4*q2 + q3))/2 - 2*qd3^2*qdd1*qdd3*sin(2*q2 + q3) - 2*qd1^3*qd2*qdd2*cos(3*q3) - qd1^3*qd2*qdd3*cos(3*q3) - qd1^3*qd3*qdd2*cos(3*q3) - qd1^2*qd2^2*qdd1*cos(q3) - (qd1^2*qd3^2*qdd1*cos(q3))/2 + g*qdd1*qdd2*cos(q2 + q3) - 8*g*qdd1*qdd3*cos(q2 + q3) + (qd1^2*qdd1*qdd3*sin(3*q3))/2 - qd1^3*qd2*qd3^2*sin(q3) - qd1^3*qd2^2*qd3*sin(q3) + 2*g*qd1*qd2^3*cos(3*q2 + 3*q3) + g*qd1^3*qd3*cos(5*q2 + 3*q3) + 4*qd1*qd2^3*qdd2*cos(2*q2 - q3) + 2*qd1^3*qd2*qdd2*cos(2*q2 - q3) + 4*qd1*qd2^3*qdd3*cos(2*q2 - q3) + 2*qd1^3*qd2*qdd3*cos(2*q2 - q3) + 2*qd1^3*qd3*qdd2*cos(2*q2 - q3) + 4*qd1*qd2^3*qdd2*cos(2*q2 + 3*q3) + 2*qd1^3*qd2*qdd2*cos(2*q2 + 3*q3) + 2*qd1^3*qd3*qdd3*cos(2*q2 - q3) + qd1^3*qd2*qdd3*cos(4*q2 + 3*q3) + qd1^3*qd3*qdd2*cos(4*q2 + 3*q3) - 2*qd1^2*qd2^2*qdd1*cos(2*q2 + q3) - qd1^2*qd3^2*qdd1*cos(2*q2 + q3) - (qd1^2*qd3^2*qdd1*cos(4*q2 + q3))/2 - 2*g^2*qd1*qd2*sin(2*q2 + 3*q3) - 2*g^2*qd1*qd3*sin(2*q2 + 3*q3) - 2*g^2*qd1*qd2*sin(4*q2 + 3*q3) - 2*g^2*qd1*qd3*sin(4*q2 + 3*q3) - g*qd1^2*qdd1*sin(3*q2 + 3*q3) + g*qd2^2*qdd1*sin(3*q2 + 3*q3) - 4*qd1*qd2*qdd2^2*sin(2*q2 - q3) - 4*qd1*qd2*qdd3^2*sin(2*q2 - q3) - 4*qd1*qd2*qdd2^2*sin(2*q2 + 3*q3) - 4*qd1*qd3*qdd2^2*sin(2*q2 + 3*q3) - qd1^2*qdd1*qdd3*sin(2*q2 - q3) + 2*qd2^2*qdd1*qdd2*sin(2*q2 - q3) + 2*qd2^2*qdd1*qdd3*sin(2*q2 - q3) + 2*qd3^2*qdd1*qdd2*sin(2*q2 - q3) + qd1^2*qdd1*qdd3*sin(2*q2 + 3*q3) + 2*qd2^2*qdd1*qdd2*sin(2*q2 + 3*q3) + 2*qd3^2*qdd1*qdd3*sin(2*q2 - q3) + (qd1^2*qdd1*qdd3*sin(4*q2 + 3*q3))/2 + qd1^3*qd2*qd3^2*sin(4*q2 + q3) + qd1^3*qd2^2*qd3*sin(4*q2 + q3) + qd1^2*qd2^2*qdd1*cos(3*q3) + (qd1^2*qd3^2*qdd1*cos(3*q3))/2 - 2*g*qdd1*qdd2*cos(q2 - q3) - 4*g*qdd1*qdd3*cos(q2 - q3) + g*qdd1*qdd2*cos(q2 + 3*q3) - 3*g*qdd1*qdd2*cos(3*q2 + q3) - 4*g*qdd1*qdd3*cos(3*q2 + q3) - 2*g*qd1*qd2^3*cos(q2 + q3) + qd1^3*qd2*qd3^2*sin(3*q3) + qd1^3*qd2^2*qd3*sin(3*q3) - 4*qdd1*qdd2*qdd3*cos(2*q2 + q3) - g*qd1^2*qdd1*sin(q2 + q3) + g*qd2^2*qdd1*sin(q2 + q3) + qd1^2*qd2^2*qdd1*cos(2*q2 - q3) + qd1^2*qd2^2*qdd1*cos(2*q2 + 3*q3) + qd1^2*qd3^2*qdd1*cos(2*q2 + 3*q3) + (qd1^2*qd3^2*qdd1*cos(4*q2 + 3*q3))/2 - qd1^3*qd2*qd3^2*sin(4*q2 + 3*q3) - qd1^3*qd2^2*qd3*sin(4*q2 + 3*q3) + 2*qd1^3*qd2*qdd2*cos(q3) + qd1^3*qd2*qdd3*cos(q3) + qd1^3*qd3*qdd2*cos(q3) + 2*qd1^3*qd3*qdd3*cos(q3) - 2*g^2*qd1*qd2*sin(q3) - 2*g^2*qd1*qd3*sin(q3) + 8*qd1*qd3*qdd2^2*sin(q3) + (3*qd1^2*qdd1*qdd3*sin(q3))/2 - 4*qd2^2*qdd1*qdd3*sin(q3) - 4*qd3^2*qdd1*qdd2*sin(q3) - 4*qd3^2*qdd1*qdd3*sin(q3) - 8*qd2*qd3*qdd1*qdd2*sin(q3) + 8*qd1*qd3*qdd2*qdd3*sin(q3) - 8*qd2*qd3*qdd1*qdd3*sin(q3) - 2*g*qd1*qd2^2*qd3*cos(q2 + q3) - 4*g*qd1*qd3*qdd2*sin(q2 - q3) - 2*g*qd1*qd2*qdd2*sin(q2 + 3*q3) + 6*g*qd1*qd2*qdd2*sin(3*q2 + q3) - 4*g*qd1*qd3*qdd3*sin(q2 - q3) + 8*g*qd1*qd2*qdd3*sin(3*q2 + q3) - 2*g*qd1*qd3*qdd2*sin(q2 + 3*q3) + 2*g*qd1*qd3*qdd2*sin(3*q2 + q3) + 4*g*qd1*qd3*qdd3*sin(3*q2 + q3) + 8*qd1*qd2*qdd2*qdd3*sin(2*q2 + q3) - 4*qd2*qd3*qdd1*qdd2*sin(2*q2 + q3) + 8*qd1*qd3*qdd2*qdd3*sin(2*q2 + q3) - 4*qd2*qd3*qdd1*qdd3*sin(2*q2 + q3) - qd1^2*qd2*qd3*qdd1*cos(q3) + 2*g*qd1*qd2^2*qd3*cos(q2 + 3*q3) - 2*g*qd1*qd2^2*qd3*cos(3*q2 + q3) - 2*qd1^2*qd2*qd3*qdd1*cos(2*q2 + q3) - 4*qd1*qd2*qd3^2*qdd2*cos(2*q2 + q3) - 12*qd1*qd2^2*qd3*qdd2*cos(2*q2 + q3) - 4*qd1*qd2*qd3^2*qdd3*cos(2*q2 + q3) - 8*qd1*qd2^2*qd3*qdd3*cos(2*q2 + q3) - qd1^2*qd2*qd3*qdd1*cos(4*q2 + q3) - 6*g*qd1*qd2*qdd2*sin(3*q2 + 3*q3) - 6*g*qd1*qd3*qdd2*sin(3*q2 + 3*q3) - 8*qd1*qd2*qdd2*qdd3*sin(2*q2 - q3) + 4*qd2*qd3*qdd1*qdd2*sin(2*q2 - q3) + 4*qd2*qd3*qdd1*qdd3*sin(2*q2 - q3) + qd1^2*qd2*qd3*qdd1*cos(3*q3) + 2*g*qd1*qd2*qdd2*sin(q2 + q3) + 8*g*qd1*qd2*qdd3*sin(q2 + q3) + 2*g*qd1*qd3*qdd2*sin(q2 + q3) + 8*g*qd1*qd3*qdd3*sin(q2 + q3) + 2*g*qd1*qd2^2*qd3*cos(3*q2 + 3*q3) + 4*qd1*qd2*qd3^2*qdd2*cos(2*q2 - q3) + 8*qd1*qd2^2*qd3*qdd2*cos(2*q2 - q3) + 4*qd1*qd2*qd3^2*qdd3*cos(2*q2 - q3) + 8*qd1*qd2^2*qd3*qdd3*cos(2*q2 - q3) + 2*qd1^2*qd2*qd3*qdd1*cos(2*q2 + 3*q3) + 4*qd1*qd2^2*qd3*qdd2*cos(2*q2 + 3*q3) + qd1^2*qd2*qd3*qdd1*cos(4*q2 + 3*q3)))/(2*qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), (2*(2*qdd1*qdd2^2*cos(2*q2 - q3) + 2*qdd1*qdd3^2*cos(2*q2 - q3) + 2*qdd1*qdd2^2*cos(2*q2 + 3*q3) + 3*g^2*qdd1*cos(q3) + 4*qdd1*qdd3^2*cos(q3) + 3*g^2*qdd1*cos(2*q2 + q3) - 4*qdd1*qdd2^2*cos(2*q2 + q3) + 2*qdd1*qdd3^2*cos(2*q2 + q3) + g^2*qdd1*cos(2*q2 + 3*q3) + g^2*qdd1*cos(4*q2 + 3*q3) + 3*g*qdd1*qdd2*cos(3*q2 + 3*q3) - g*qd1^3*qd3*cos(q2 - q3) + 2*g*qd1*qd2^3*cos(q2 + 3*q3) - 2*g*qd1*qd2^3*cos(3*q2 + q3) - g*qd1^3*qd3*cos(q2 + 3*q3) + g*qd1^3*qd3*cos(3*q2 + q3) + 4*qdd1*qdd2*qdd3*cos(2*q2 - q3) - 8*qd1*qd2^3*qdd2*cos(2*q2 + q3) - 4*qd1^3*qd2*qdd2*cos(2*q2 + q3) - 4*qd1*qd2^3*qdd3*cos(2*q2 + q3) - 2*qd1^3*qd2*qdd3*cos(2*q2 + q3) - 2*qd1^3*qd3*qdd2*cos(2*q2 + q3) - 2*qd1^3*qd3*qdd3*cos(2*q2 + q3) - qd1^3*qd2*qdd3*cos(4*q2 + q3) - qd1^3*qd3*qdd2*cos(4*q2 + q3) - 2*qd1^3*qd3*qdd3*cos(4*q2 + q3) - 2*g^2*qd1*qd2*sin(2*q2 + q3) - 2*g^2*qd1*qd3*sin(2*q2 + q3) + 2*g*qd1^2*qdd1*sin(q2 - q3) - 2*g*qd2^2*qdd1*sin(q2 - q3) - g*qd1^2*qdd1*sin(q2 + 3*q3) + g*qd1^2*qdd1*sin(3*q2 + q3) + g*qd2^2*qdd1*sin(q2 + 3*q3) - g*qd2^2*qdd1*sin(3*q2 + q3) + 8*qd1*qd2*qdd2^2*sin(2*q2 + q3) - 4*qd1*qd2*qdd3^2*sin(2*q2 + q3) + 4*qd1*qd3*qdd2^2*sin(2*q2 + q3) - 4*qd2^2*qdd1*qdd2*sin(2*q2 + q3) - 2*qd2^2*qdd1*qdd3*sin(2*q2 + q3) - 2*qd3^2*qdd1*qdd2*sin(2*q2 + q3) - (qd1^2*qdd1*qdd3*sin(4*q2 + q3))/2 - 2*qd3^2*qdd1*qdd3*sin(2*q2 + q3) - 2*qd1^3*qd2*qdd2*cos(3*q3) - qd1^3*qd2*qdd3*cos(3*q3) - qd1^3*qd3*qdd2*cos(3*q3) - qd1^2*qd2^2*qdd1*cos(q3) - (qd1^2*qd3^2*qdd1*cos(q3))/2 + g*qdd1*qdd2*cos(q2 + q3) - 8*g*qdd1*qdd3*cos(q2 + q3) + (qd1^2*qdd1*qdd3*sin(3*q3))/2 - qd1^3*qd2*qd3^2*sin(q3) - qd1^3*qd2^2*qd3*sin(q3) + 2*g*qd1*qd2^3*cos(3*q2 + 3*q3) + g*qd1^3*qd3*cos(5*q2 + 3*q3) + 4*qd1*qd2^3*qdd2*cos(2*q2 - q3) + 2*qd1^3*qd2*qdd2*cos(2*q2 - q3) + 4*qd1*qd2^3*qdd3*cos(2*q2 - q3) + 2*qd1^3*qd2*qdd3*cos(2*q2 - q3) + 2*qd1^3*qd3*qdd2*cos(2*q2 - q3) + 4*qd1*qd2^3*qdd2*cos(2*q2 + 3*q3) + 2*qd1^3*qd2*qdd2*cos(2*q2 + 3*q3) + 2*qd1^3*qd3*qdd3*cos(2*q2 - q3) + qd1^3*qd2*qdd3*cos(4*q2 + 3*q3) + qd1^3*qd3*qdd2*cos(4*q2 + 3*q3) - 2*qd1^2*qd2^2*qdd1*cos(2*q2 + q3) - qd1^2*qd3^2*qdd1*cos(2*q2 + q3) - (qd1^2*qd3^2*qdd1*cos(4*q2 + q3))/2 - 2*g^2*qd1*qd2*sin(2*q2 + 3*q3) - 2*g^2*qd1*qd3*sin(2*q2 + 3*q3) - 2*g^2*qd1*qd2*sin(4*q2 + 3*q3) - 2*g^2*qd1*qd3*sin(4*q2 + 3*q3) - g*qd1^2*qdd1*sin(3*q2 + 3*q3) + g*qd2^2*qdd1*sin(3*q2 + 3*q3) - 4*qd1*qd2*qdd2^2*sin(2*q2 - q3) - 4*qd1*qd2*qdd3^2*sin(2*q2 - q3) - 4*qd1*qd2*qdd2^2*sin(2*q2 + 3*q3) - 4*qd1*qd3*qdd2^2*sin(2*q2 + 3*q3) - qd1^2*qdd1*qdd3*sin(2*q2 - q3) + 2*qd2^2*qdd1*qdd2*sin(2*q2 - q3) + 2*qd2^2*qdd1*qdd3*sin(2*q2 - q3) + 2*qd3^2*qdd1*qdd2*sin(2*q2 - q3) + qd1^2*qdd1*qdd3*sin(2*q2 + 3*q3) + 2*qd2^2*qdd1*qdd2*sin(2*q2 + 3*q3) + 2*qd3^2*qdd1*qdd3*sin(2*q2 - q3) + (qd1^2*qdd1*qdd3*sin(4*q2 + 3*q3))/2 + qd1^3*qd2*qd3^2*sin(4*q2 + q3) + qd1^3*qd2^2*qd3*sin(4*q2 + q3) + qd1^2*qd2^2*qdd1*cos(3*q3) + (qd1^2*qd3^2*qdd1*cos(3*q3))/2 - 2*g*qdd1*qdd2*cos(q2 - q3) - 4*g*qdd1*qdd3*cos(q2 - q3) + g*qdd1*qdd2*cos(q2 + 3*q3) - 3*g*qdd1*qdd2*cos(3*q2 + q3) - 4*g*qdd1*qdd3*cos(3*q2 + q3) - 2*g*qd1*qd2^3*cos(q2 + q3) + qd1^3*qd2*qd3^2*sin(3*q3) + qd1^3*qd2^2*qd3*sin(3*q3) - 4*qdd1*qdd2*qdd3*cos(2*q2 + q3) - g*qd1^2*qdd1*sin(q2 + q3) + g*qd2^2*qdd1*sin(q2 + q3) + qd1^2*qd2^2*qdd1*cos(2*q2 - q3) + qd1^2*qd2^2*qdd1*cos(2*q2 + 3*q3) + qd1^2*qd3^2*qdd1*cos(2*q2 + 3*q3) + (qd1^2*qd3^2*qdd1*cos(4*q2 + 3*q3))/2 - qd1^3*qd2*qd3^2*sin(4*q2 + 3*q3) - qd1^3*qd2^2*qd3*sin(4*q2 + 3*q3) + 2*qd1^3*qd2*qdd2*cos(q3) + qd1^3*qd2*qdd3*cos(q3) + qd1^3*qd3*qdd2*cos(q3) + 2*qd1^3*qd3*qdd3*cos(q3) - 2*g^2*qd1*qd2*sin(q3) - 2*g^2*qd1*qd3*sin(q3) + 8*qd1*qd3*qdd2^2*sin(q3) + (3*qd1^2*qdd1*qdd3*sin(q3))/2 - 4*qd2^2*qdd1*qdd3*sin(q3) - 4*qd3^2*qdd1*qdd2*sin(q3) - 4*qd3^2*qdd1*qdd3*sin(q3) - 8*qd2*qd3*qdd1*qdd2*sin(q3) + 8*qd1*qd3*qdd2*qdd3*sin(q3) - 8*qd2*qd3*qdd1*qdd3*sin(q3) - 2*g*qd1*qd2^2*qd3*cos(q2 + q3) - 4*g*qd1*qd3*qdd2*sin(q2 - q3) - 2*g*qd1*qd2*qdd2*sin(q2 + 3*q3) + 6*g*qd1*qd2*qdd2*sin(3*q2 + q3) - 4*g*qd1*qd3*qdd3*sin(q2 - q3) + 8*g*qd1*qd2*qdd3*sin(3*q2 + q3) - 2*g*qd1*qd3*qdd2*sin(q2 + 3*q3) + 2*g*qd1*qd3*qdd2*sin(3*q2 + q3) + 4*g*qd1*qd3*qdd3*sin(3*q2 + q3) + 8*qd1*qd2*qdd2*qdd3*sin(2*q2 + q3) - 4*qd2*qd3*qdd1*qdd2*sin(2*q2 + q3) + 8*qd1*qd3*qdd2*qdd3*sin(2*q2 + q3) - 4*qd2*qd3*qdd1*qdd3*sin(2*q2 + q3) - qd1^2*qd2*qd3*qdd1*cos(q3) + 2*g*qd1*qd2^2*qd3*cos(q2 + 3*q3) - 2*g*qd1*qd2^2*qd3*cos(3*q2 + q3) - 2*qd1^2*qd2*qd3*qdd1*cos(2*q2 + q3) - 4*qd1*qd2*qd3^2*qdd2*cos(2*q2 + q3) - 12*qd1*qd2^2*qd3*qdd2*cos(2*q2 + q3) - 4*qd1*qd2*qd3^2*qdd3*cos(2*q2 + q3) - 8*qd1*qd2^2*qd3*qdd3*cos(2*q2 + q3) - qd1^2*qd2*qd3*qdd1*cos(4*q2 + q3) - 6*g*qd1*qd2*qdd2*sin(3*q2 + 3*q3) - 6*g*qd1*qd3*qdd2*sin(3*q2 + 3*q3) - 8*qd1*qd2*qdd2*qdd3*sin(2*q2 - q3) + 4*qd2*qd3*qdd1*qdd2*sin(2*q2 - q3) + 4*qd2*qd3*qdd1*qdd3*sin(2*q2 - q3) + qd1^2*qd2*qd3*qdd1*cos(3*q3) + 2*g*qd1*qd2*qdd2*sin(q2 + q3) + 8*g*qd1*qd2*qdd3*sin(q2 + q3) + 2*g*qd1*qd3*qdd2*sin(q2 + q3) + 8*g*qd1*qd3*qdd3*sin(q2 + q3) + 2*g*qd1*qd2^2*qd3*cos(3*q2 + 3*q3) + 4*qd1*qd2*qd3^2*qdd2*cos(2*q2 - q3) + 8*qd1*qd2^2*qd3*qdd2*cos(2*q2 - q3) + 4*qd1*qd2*qd3^2*qdd3*cos(2*q2 - q3) + 8*qd1*qd2^2*qd3*qdd3*cos(2*q2 - q3) + 2*qd1^2*qd2*qd3*qdd1*cos(2*q2 + 3*q3) + 4*qd1*qd2^2*qd3*qdd2*cos(2*q2 + 3*q3) + qd1^2*qd2*qd3*qdd1*cos(4*q2 + 3*q3)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), (6*qdd1*qdd2^2 + qd1^4*qdd1*cos(4*q2 + 3*q3) - 6*qdd1*qdd2^2*cos(2*q2 + 2*q3) - qd1^4*qdd1*cos(q3) + 8*qdd1*qdd2^2*cos(q3) + 6*qdd1*qdd2*qdd3 + 8*g^2*qdd1*cos(q2 + q3)*cos(q2) - 6*qdd1*qdd2*qdd3*cos(2*q2 + 2*q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2 + q3) + 8*g*qdd1*qdd2*cos(q2 + q3) + 3*qd1^2*qdd1*qdd2*sin(2*q2) + 3*qd1^2*qdd1*qdd3*sin(2*q2) + 3*qd1^4*qdd1*sin(2*q2)*sin(2*q2 + 2*q3) + 4*qd1^3*qd2*qdd2*cos(4*q2 + 3*q3) + 6*g*qdd1*qdd2*cos(q2) + 6*g*qdd1*qdd3*cos(q2) + 12*qd1*qd2*qdd2^2*sin(2*q2 + 2*q3) + 12*qd1*qd3*qdd2^2*sin(2*q2 + 2*q3) + 6*qd1^2*qdd1*qdd2*sin(2*q2 + 2*q3) + 2*qd1^2*qdd1*qdd2*sin(4*q2 + 3*q3) + 2*qd1^4*qdd1*sin(2*q2)*sin(q3) - 8*qdd1*qdd2^2*cos(2*q2 + 2*q3)*cos(q3) - 4*qd1^3*qd2*qdd2*cos(q3) + 10*qd1^2*qdd1*qdd2*sin(q3) + 8*qd2^2*qdd1*qdd2*sin(q3) + 2*qd1^4*qdd1*sin(2*q2 + q3)*sin(2*q2) + 2*qd1^4*qdd1*sin(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2)*cos(q3) + 2*qd1^4*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 2*qd1^4*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*sin(q3) + 4*qd1^4*qdd1*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 6*g*qd1^2*qdd1*sin(2*q2 + 2*q3)*cos(q2) + 8*g*qdd1*qdd2*cos(q2)*cos(q3) + 16*qd1*qd2*qdd2^2*sin(2*q2 + 2*q3)*cos(q3) + 16*qd1*qd3*qdd2^2*sin(2*q2 + 2*q3)*cos(q3) - 4*qd1^2*qdd1*qdd2*cos(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2 + 2*q3)*cos(q3) - 4*qd1^2*qdd1*qdd3*sin(2*q2 + 2*q3)*cos(q3) - 8*qd2^2*qdd1*qdd2*cos(2*q2 + 2*q3)*sin(q3) + 4*qd1^4*qdd1*cos(2*q2 + q3)*sin(2*q2)*sin(2*q2 + 2*q3) - 2*qd1^4*qdd1*sin(2*q2 + q3)*cos(2*q2)*sin(2*q2 + 2*q3) - 2*qd1^4*qdd1*sin(2*q2 + q3)*sin(2*q2)*cos(2*q2 + 2*q3) + 16*qd1*qd2^3*qdd2*sin(2*q2 + 2*q3)*sin(q3) + 8*qd1^3*qd2*qdd2*sin(2*q2 + 2*q3)*sin(q3) - 8*g^2*qdd1*cos(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) + 12*qd1*qd2*qdd2*qdd3*sin(2*q2 + 2*q3) + 12*qd1*qd3*qdd2*qdd3*sin(2*q2 + 2*q3) + 4*qd1^2*qd2^2*qdd1*sin(2*q2)*sin(q3) - 8*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2 + q3) - 3*qd1^2*qdd1*qdd2*sin(2*q2)*cos(2*q2 + 2*q3) - 3*qd1^2*qdd1*qdd3*sin(2*q2)*cos(2*q2 + 2*q3) + 4*g*qd1^2*qdd1*cos(q2)*sin(q3) + 8*g*qd2^2*qdd1*cos(q2)*sin(q3) + 6*qd1^3*qd2*qdd2*sin(2*q2)*sin(2*q2 + 2*q3) + 6*qd1^3*qd2*qdd3*sin(2*q2)*sin(2*q2 + 2*q3) + 6*qd1^3*qd3*qdd2*sin(2*q2)*sin(2*q2 + 2*q3) + 6*qd1^3*qd3*qdd3*sin(2*q2)*sin(2*q2 + 2*q3) + 4*qd1^2*qd2^2*qdd1*sin(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qd3^2*qdd1*sin(2*q2 + 2*q3)*sin(q3) - 6*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2) - 6*g*qdd1*qdd3*cos(2*q2 + 2*q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2 + q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2)*cos(q2 + q3) - 8*qd1^3*qd2*qd3^2*sin(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 8*qd1^3*qd2^2*qd3*sin(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 4*g*qd1^2*qdd1*cos(2*q2 + 2*q3)*cos(q2)*sin(q3) + 8*g*qd1^2*qdd1*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) - 8*g*qd2^2*qdd1*cos(2*q2 + 2*q3)*cos(q2)*sin(q3) + 16*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2 + q3) + 16*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2 + q3) + 16*g*qd1*qd2^3*sin(2*q2 + 2*q3)*cos(q2)*sin(q3) + 8*g*qd1^3*qd2*sin(2*q2 + 2*q3)*cos(q2)*sin(q3) + 8*g*qd1^2*qdd1*cos(2*q2 + q3)*sin(2*q2 + 2*q3)*cos(q2) - 4*g*qd1^2*qdd1*sin(2*q2 + q3)*cos(2*q2 + 2*q3)*cos(q2) - 4*g*qd1^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*cos(q2 + q3) + 12*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd2*qdd3*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd3*qdd3*sin(2*q2 + 2*q3)*cos(q2) - 8*g*qd1^3*qd2*sin(2*q2 + q3)*sin(2*q2 + 2*q3)*cos(q2) + 8*g*qd1^3*qd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q2 + q3) + 8*g*qd1^3*qd3*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q2 + q3) - 4*qd1^2*qdd1*qdd2*cos(2*q2)*sin(2*q2 + 2*q3)*cos(q3) - 4*qd1^2*qdd1*qdd2*sin(2*q2)*cos(2*q2 + 2*q3)*cos(q3) - 4*qd1^2*qdd1*qdd3*cos(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 16*qd1^3*qd2*qdd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 8*qd1^3*qd2*qdd3*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 8*qd1^3*qd3*qdd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) - 8*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2)*cos(q3) + 8*qd1^2*qd2*qd3*qdd1*sin(2*q2 + 2*q3)*sin(q3) + 16*qd1*qd2^2*qd3*qdd2*sin(2*q2 + 2*q3)*sin(q3) + 16*g^2*qd1*qd2*sin(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) + 16*g^2*qd1*qd3*sin(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) + 4*qd1^2*qd2^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 4*qd1^2*qd2^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qd3^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 8*qd1^2*qd2*qd3*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 16*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) + 16*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) + 16*g*qd1*qd2^2*qd3*sin(2*q2 + 2*q3)*cos(q2)*sin(q3))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), (6*qdd1*qdd2^2 - qd1^4*qdd1*cos(4*q2 + 3*q3) + 6*qdd1*qdd2^2*cos(2*q2 + 2*q3) + qd1^4*qdd1*cos(q3) + 8*qdd1*qdd2^2*cos(q3) + 6*qdd1*qdd2*qdd3 + 8*g^2*qdd1*cos(q2 + q3)*cos(q2) + 6*qdd1*qdd2*qdd3*cos(2*q2 + 2*q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2 + q3) + 8*g*qdd1*qdd2*cos(q2 + q3) + 3*qd1^2*qdd1*qdd2*sin(2*q2) + 3*qd1^2*qdd1*qdd3*sin(2*q2) - 4*qd1^3*qd2*qdd2*cos(4*q2 + 3*q3) + 6*g*qdd1*qdd2*cos(q2) + 6*g*qdd1*qdd3*cos(q2) - 12*qd1*qd2*qdd2^2*sin(2*q2 + 2*q3) - 12*qd1*qd3*qdd2^2*sin(2*q2 + 2*q3) - 2*qd1^2*qdd1*qdd2*sin(4*q2 + 3*q3) + 2*qd1^4*qdd1*sin(2*q2)*sin(q3) + 8*qdd1*qdd2^2*cos(2*q2 + 2*q3)*cos(q3) + 4*qd1^3*qd2*qdd2*cos(q3) - 2*qd1^2*qdd1*qdd2*sin(q3) + 8*qd2^2*qdd1*qdd2*sin(q3) + 2*qd1^4*qdd1*sin(2*q2 + q3)*sin(2*q2) - 2*qd1^4*qdd1*sin(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2)*cos(q3) - 2*qd1^4*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 2*qd1^4*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*sin(q3) - 4*qd1^4*qdd1*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 8*g*qdd1*qdd2*cos(q2)*cos(q3) - 16*qd1*qd2*qdd2^2*sin(2*q2 + 2*q3)*cos(q3) - 16*qd1*qd3*qdd2^2*sin(2*q2 + 2*q3)*cos(q3) + 4*qd1^2*qdd1*qdd2*cos(2*q2 + 2*q3)*sin(q3) - 4*qd1^2*qdd1*qdd2*sin(2*q2 + 2*q3)*cos(q3) + 4*qd1^2*qdd1*qdd3*sin(2*q2 + 2*q3)*cos(q3) + 8*qd2^2*qdd1*qdd2*cos(2*q2 + 2*q3)*sin(q3) - 4*qd1^4*qdd1*cos(2*q2 + q3)*sin(2*q2)*sin(2*q2 + 2*q3) + 2*qd1^4*qdd1*sin(2*q2 + q3)*cos(2*q2)*sin(2*q2 + 2*q3) + 2*qd1^4*qdd1*sin(2*q2 + q3)*sin(2*q2)*cos(2*q2 + 2*q3) - 16*qd1*qd2^3*qdd2*sin(2*q2 + 2*q3)*sin(q3) - 8*qd1^3*qd2*qdd2*sin(2*q2 + 2*q3)*sin(q3) + 8*g^2*qdd1*cos(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) - 12*qd1*qd2*qdd2*qdd3*sin(2*q2 + 2*q3) - 12*qd1*qd3*qdd2*qdd3*sin(2*q2 + 2*q3) + 4*qd1^2*qd2^2*qdd1*sin(2*q2)*sin(q3) + 8*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2 + q3) + 3*qd1^2*qdd1*qdd2*sin(2*q2)*cos(2*q2 + 2*q3) + 3*qd1^2*qdd1*qdd3*sin(2*q2)*cos(2*q2 + 2*q3) + 4*g*qd1^2*qdd1*cos(q2)*sin(q3) + 8*g*qd2^2*qdd1*cos(q2)*sin(q3) - 6*qd1^3*qd2*qdd2*sin(2*q2)*sin(2*q2 + 2*q3) - 6*qd1^3*qd2*qdd3*sin(2*q2)*sin(2*q2 + 2*q3) - 6*qd1^3*qd3*qdd2*sin(2*q2)*sin(2*q2 + 2*q3) - 6*qd1^3*qd3*qdd3*sin(2*q2)*sin(2*q2 + 2*q3) - 4*qd1^2*qd2^2*qdd1*sin(2*q2 + 2*q3)*sin(q3) - 4*qd1^2*qd3^2*qdd1*sin(2*q2 + 2*q3)*sin(q3) + 6*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2) + 6*g*qdd1*qdd3*cos(2*q2 + 2*q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2 + q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2)*cos(q2 + q3) + 8*qd1^3*qd2*qd3^2*sin(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 8*qd1^3*qd2^2*qd3*sin(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 4*g*qd1^2*qdd1*cos(2*q2 + 2*q3)*cos(q2)*sin(q3) - 8*g*qd1^2*qdd1*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) + 8*g*qd2^2*qdd1*cos(2*q2 + 2*q3)*cos(q2)*sin(q3) - 16*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2 + q3) - 16*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2 + q3) - 16*g*qd1*qd2^3*sin(2*q2 + 2*q3)*cos(q2)*sin(q3) - 8*g*qd1^3*qd2*sin(2*q2 + 2*q3)*cos(q2)*sin(q3) - 8*g*qd1^2*qdd1*cos(2*q2 + q3)*sin(2*q2 + 2*q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2 + q3)*cos(2*q2 + 2*q3)*cos(q2) + 4*g*qd1^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*cos(q2 + q3) - 12*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2) - 12*g*qd1*qd2*qdd3*sin(2*q2 + 2*q3)*cos(q2) - 12*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2) - 12*g*qd1*qd3*qdd3*sin(2*q2 + 2*q3)*cos(q2) + 8*g*qd1^3*qd2*sin(2*q2 + q3)*sin(2*q2 + 2*q3)*cos(q2) - 8*g*qd1^3*qd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q2 + q3) - 8*g*qd1^3*qd3*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q2 + q3) + 4*qd1^2*qdd1*qdd2*cos(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 4*qd1^2*qdd1*qdd2*sin(2*q2)*cos(2*q2 + 2*q3)*cos(q3) + 4*qd1^2*qdd1*qdd3*cos(2*q2)*sin(2*q2 + 2*q3)*cos(q3) - 16*qd1^3*qd2*qdd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) - 8*qd1^3*qd2*qdd3*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) - 8*qd1^3*qd3*qdd2*sin(2*q2)*sin(2*q2 + 2*q3)*cos(q3) + 8*g*qdd1*qdd2*cos(2*q2 + 2*q3)*cos(q2)*cos(q3) - 8*qd1^2*qd2*qd3*qdd1*sin(2*q2 + 2*q3)*sin(q3) - 16*qd1*qd2^2*qd3*qdd2*sin(2*q2 + 2*q3)*sin(q3) - 16*g^2*qd1*qd2*sin(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) - 16*g^2*qd1*qd3*sin(2*q2 + 2*q3)*cos(q2 + q3)*cos(q2) - 4*qd1^2*qd2^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) + 4*qd1^2*qd2^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3)*sin(q3) - 4*qd1^2*qd3^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 8*qd1^2*qd2*qd3*qdd1*cos(2*q2)*sin(2*q2 + 2*q3)*sin(q3) - 16*g*qd1*qd2*qdd2*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) - 16*g*qd1*qd3*qdd2*sin(2*q2 + 2*q3)*cos(q2)*cos(q3) - 16*g*qd1*qd2^2*qd3*sin(2*q2 + 2*q3)*cos(q2)*sin(q3))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), ((qdd2 + qdd3)*(8*qdd1*qdd3*cos(q3) - 6*g*qdd1*cos(q2) - 8*qdd1*qdd2*cos(q3) - 6*qdd1*qdd2 - 16*qdd1*qdd2*cos(2*q2 + q3) - 4*qd1^2*qdd1*sin(q3) - 8*qd2^2*qdd1*sin(q3) - 8*qd3^2*qdd1*sin(q3) - 6*qdd1*qdd2*cos(2*q2 + 2*q3) + 4*qd1^2*qdd1*sin(2*q2 + q3) - 3*qd1^2*qdd1*sin(2*q2) - 16*g*qdd1*cos(2*q2 + q3)*cos(q2) + 12*qd1*qd2*qdd2*sin(2*q2 + 2*q3) + 12*qd1*qd3*qdd2*sin(2*q2 + 2*q3) - 3*qd1^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3) + 8*qdd1*qdd2*cos(2*q2)*cos(q3) + 8*qdd1*qdd3*cos(2*q2)*cos(q3) + 6*qd1^3*qd2*sin(2*q2)*sin(2*q2 + 2*q3) + 6*qd1^3*qd3*sin(2*q2)*sin(2*q2 + 2*q3) - 6*g*qdd1*cos(2*q2 + 2*q3)*cos(q2) + 16*qd1*qd3*qdd2*sin(q3) - 16*qd2*qd3*qdd1*sin(q3) - 4*qd1^2*qdd1*cos(2*q2)*sin(q3) - 8*qd1^2*qdd1*sin(2*q2)*cos(q3) - 8*qd2^2*qdd1*cos(2*q2)*sin(q3) - 8*qd3^2*qdd1*cos(2*q2)*sin(q3) + 32*qd1*qd2*qdd2*sin(2*q2 + q3) + 16*qd1*qd3*qdd2*sin(2*q2 + q3) + 16*qd1*qd2^3*sin(2*q2)*sin(q3) + 8*qd1^3*qd2*sin(2*q2)*sin(q3) + 8*qd1^3*qd3*sin(2*q2)*sin(q3) - 16*g*qdd1*cos(q2)*cos(q3) - 8*qd1^2*qdd1*cos(2*q2 + q3)*sin(2*q2) + 4*qd1^2*qdd1*sin(2*q2 + q3)*cos(2*q2) + 8*qd1^3*qd2*sin(2*q2 + q3)*sin(2*q2) + 8*qd1^3*qd3*sin(2*q2 + q3)*sin(2*q2) + 16*qd1*qd2*qd3^2*sin(2*q2)*sin(q3) + 32*qd1*qd2^2*qd3*sin(2*q2)*sin(q3) + 16*g*qd1*qd3*cos(q2)*sin(q3) + 32*g*qd1*qd2*sin(2*q2 + q3)*cos(q2) + 16*g*qd1*qd3*sin(2*q2 + q3)*cos(q2) - 16*qd1*qd2*qdd2*sin(2*q2)*cos(q3) - 16*qd1*qd2*qdd3*sin(2*q2)*cos(q3) - 16*qd2*qd3*qdd1*cos(2*q2)*sin(q3) + 12*g*qd1*qd2*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd3*sin(2*q2 + 2*q3)*cos(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), (225*qdd3*(6*qdd1*qdd3 - 6*g*qdd1*cos(q2) + 3*qd1^2*qdd1*sin(2*q2 + 2*q3) + 8*qdd1*qdd3*cos(q3) - 16*qdd1*qdd2*cos(2*q2 + q3) + 6*qdd1*qdd2*cos(2*q2) + 6*qdd1*qdd3*cos(2*q2) - 8*qd3^2*qdd1*sin(q3) - 6*qdd1*qdd2*cos(2*q2 + 2*q3) + 8*qd1^2*qdd1*sin(2*q2 + q3) + 8*g*qdd1*cos(q2 + q3) - 3*qd1^2*qdd1*sin(2*q2) - 16*g*qdd1*cos(2*q2 + q3)*cos(q2) + 8*g*qdd1*cos(2*q2)*cos(q2 + q3) + 12*qd1*qd2*qdd2*sin(2*q2 + 2*q3) + 12*qd1*qd3*qdd2*sin(2*q2 + 2*q3) + 3*qd1^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3) - 3*qd1^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3) + 16*qdd1*qdd2*cos(2*q2)*cos(q3) + 8*qdd1*qdd3*cos(2*q2)*cos(q3) + 6*qd1^3*qd3*sin(2*q2)*sin(2*q2 + 2*q3) - 6*g*qdd1*cos(2*q2 + 2*q3)*cos(q2) + 16*qd1*qd3*qdd2*sin(q3) - 16*qd2*qd3*qdd1*sin(q3) - 8*qd1^2*qdd1*sin(2*q2)*cos(q3) - 8*qd3^2*qdd1*cos(2*q2)*sin(q3) + 32*qd1*qd2*qdd2*sin(2*q2 + q3) + 16*qd1*qd3*qdd2*sin(2*q2 + q3) + 8*qd1^3*qd3*sin(2*q2)*sin(q3) - 16*g*qdd1*cos(q2)*cos(q3) - 8*qd1^2*qdd1*cos(2*q2 + q3)*sin(2*q2) + 8*qd1^2*qdd1*sin(2*q2 + q3)*cos(2*q2) - 12*qd1*qd2*qdd2*sin(2*q2) - 12*qd1*qd2*qdd3*sin(2*q2) + 8*qd1^3*qd3*sin(2*q2 + q3)*sin(2*q2) + 16*qd1*qd2*qd3^2*sin(2*q2)*sin(q3) + 32*qd1*qd2^2*qd3*sin(2*q2)*sin(q3) + 16*g*qd1*qd3*cos(q2)*sin(q3) + 32*g*qd1*qd2*sin(2*q2 + q3)*cos(q2) - 16*g*qd1*qd2*sin(2*q2)*cos(q2 + q3) + 16*g*qd1*qd3*sin(2*q2 + q3)*cos(q2) - 32*qd1*qd2*qdd2*sin(2*q2)*cos(q3) - 16*qd1*qd2*qdd3*sin(2*q2)*cos(q3) - 16*qd2*qd3*qdd1*cos(2*q2)*sin(q3) + 12*g*qd1*qd2*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd3*sin(2*q2 + 2*q3)*cos(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))), (225*qd3*(6*qdd1*qdd3 - 6*g*qdd1*cos(q2) + 3*qd1^2*qdd1*sin(2*q2 + 2*q3) + 8*qdd1*qdd3*cos(q3) - 16*qdd1*qdd2*cos(2*q2 + q3) + 6*qdd1*qdd2*cos(2*q2) + 6*qdd1*qdd3*cos(2*q2) - 8*qd3^2*qdd1*sin(q3) - 6*qdd1*qdd2*cos(2*q2 + 2*q3) + 8*qd1^2*qdd1*sin(2*q2 + q3) + 8*g*qdd1*cos(q2 + q3) - 3*qd1^2*qdd1*sin(2*q2) - 16*g*qdd1*cos(2*q2 + q3)*cos(q2) + 8*g*qdd1*cos(2*q2)*cos(q2 + q3) + 12*qd1*qd2*qdd2*sin(2*q2 + 2*q3) + 12*qd1*qd3*qdd2*sin(2*q2 + 2*q3) + 3*qd1^2*qdd1*cos(2*q2)*sin(2*q2 + 2*q3) - 3*qd1^2*qdd1*sin(2*q2)*cos(2*q2 + 2*q3) + 16*qdd1*qdd2*cos(2*q2)*cos(q3) + 8*qdd1*qdd3*cos(2*q2)*cos(q3) + 6*qd1^3*qd3*sin(2*q2)*sin(2*q2 + 2*q3) - 6*g*qdd1*cos(2*q2 + 2*q3)*cos(q2) + 16*qd1*qd3*qdd2*sin(q3) - 16*qd2*qd3*qdd1*sin(q3) - 8*qd1^2*qdd1*sin(2*q2)*cos(q3) - 8*qd3^2*qdd1*cos(2*q2)*sin(q3) + 32*qd1*qd2*qdd2*sin(2*q2 + q3) + 16*qd1*qd3*qdd2*sin(2*q2 + q3) + 8*qd1^3*qd3*sin(2*q2)*sin(q3) - 16*g*qdd1*cos(q2)*cos(q3) - 8*qd1^2*qdd1*cos(2*q2 + q3)*sin(2*q2) + 8*qd1^2*qdd1*sin(2*q2 + q3)*cos(2*q2) - 12*qd1*qd2*qdd2*sin(2*q2) - 12*qd1*qd2*qdd3*sin(2*q2) + 8*qd1^3*qd3*sin(2*q2 + q3)*sin(2*q2) + 16*qd1*qd2*qd3^2*sin(2*q2)*sin(q3) + 32*qd1*qd2^2*qd3*sin(2*q2)*sin(q3) + 16*g*qd1*qd3*cos(q2)*sin(q3) + 32*g*qd1*qd2*sin(2*q2 + q3)*cos(q2) - 16*g*qd1*qd2*sin(2*q2)*cos(q2 + q3) + 16*g*qd1*qd3*sin(2*q2 + q3)*cos(q2) - 32*qd1*qd2*qdd2*sin(2*q2)*cos(q3) - 16*qd1*qd2*qdd3*sin(2*q2)*cos(q3) - 16*qd2*qd3*qdd1*cos(2*q2)*sin(q3) + 12*g*qd1*qd2*sin(2*q2 + 2*q3)*cos(q2) + 12*g*qd1*qd3*sin(2*q2 + 2*q3)*cos(q2)))/(qdd1*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3)));...
%        0,    0,               0, 1,                -(2*(sin(2*q2)*qd1^2 + 2*qdd2 + g*cos(q2)))/(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2)),                              ((sin(2*q2)*qd1^2)/2 + qdd2)/((sin(2*q2)*qd1^2)/2 + qdd2 + g*cos(q2)),                                                                                                                                                     -(qd1^2*sin(2*q2))/(2*((sin(2*q2)*qd1^2)/2 + qdd2 + g*cos(q2))),                                                    (qd1^2*sin(2*q2))/(2*((sin(2*q2)*qd1^2)/2 + qdd2 + g*cos(q2))),                                                     (2*qdd2)/(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2)),                                                      (1800*qdd2)/(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2)),                                                      (1800*qd2)/(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2)), 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (100*qdd2^2*cos(q3) + 36*qdd3^2*cos(q3) + 96*qdd2*qdd3 + 96*qdd2^2 + 96*g*qdd2*cos(q2) + 96*g*qdd3*cos(q2) + 48*qd1^2*qdd2*sin(2*q2 + 2*q3) + 72*qdd2*qdd3*cos(q3) + 16*qd1^4*sin(2*q2)*sin(q3) + 14*qd1^2*qdd2*sin(q3) - 18*qd1^2*qdd3*sin(q3) + 28*qd2^2*qdd2*sin(q3) - 36*qd2^2*qdd3*sin(q3) - 36*qd3^2*qdd2*sin(q3) - 36*qd3^2*qdd3*sin(q3) + 16*qd1^4*sin(2*q2 + q3)*sin(2*q2) - 9*qd1^4*sin(2*q2 + 2*q3)*sin(q3) + 64*g^2*cos(q2 + q3)*cos(q2) + 50*qd1^2*qdd2*sin(2*q2 + q3) + 18*qd1^2*qdd3*sin(2*q2 + q3) + 9*qd1^4*sin(2*q2 + q3)*sin(2*q2 + 2*q3) + 64*g*qdd2*cos(q2 + q3) + 48*qd1^2*qdd2*sin(2*q2) + 48*qd1^2*qdd3*sin(2*q2) + 24*qd1^4*sin(2*q2)*sin(2*q2 + 2*q3) + 32*qd1^2*qd2^2*sin(2*q2)*sin(q3) + 32*g*qd1^2*cos(q2)*sin(q3) + 64*g*qd2^2*cos(q2)*sin(q3) - 18*qd1^2*qd2^2*sin(2*q2 + 2*q3)*sin(q3) - 18*qd1^2*qd3^2*sin(2*q2 + 2*q3)*sin(q3) + 32*g*qd1^2*sin(2*q2 + q3)*cos(q2) + 32*g*qd1^2*sin(2*q2)*cos(q2 + q3) - 72*qd2*qd3*qdd2*sin(q3) - 72*qd2*qd3*qdd3*sin(q3) + 32*qd1^2*qdd2*sin(2*q2)*cos(q3) + 48*g*qd1^2*sin(2*q2 + 2*q3)*cos(q2) + 64*g*qdd2*cos(q2)*cos(q3) + 18*qd1^2*qdd2*sin(2*q2 + 2*q3)*cos(q3) + 18*qd1^2*qdd3*sin(2*q2 + 2*q3)*cos(q3) - 36*qd1^2*qd2*qd3*sin(2*q2 + 2*q3)*sin(q3))/(3*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -(4*(sin(2*q2 + 2*q3)*qd1^2 + 2*qdd2 + 2*qdd3)*(8*qdd2 - 3*qd1^2*sin(q3) - 6*qd2^2*sin(q3) - 6*qd3^2*sin(q3) + 3*qd1^2*sin(2*q2 + q3) + 4*qd1^2*sin(2*q2) + 8*g*cos(q2) + 6*qdd2*cos(q3) + 6*qdd3*cos(q3) - 12*qd2*qd3*sin(q3)))/(3*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (4*qd1^2*sin(2*q2 + 2*q3)*(8*qdd2 - 3*qd1^2*sin(q3) - 6*qd2^2*sin(q3) - 6*qd3^2*sin(q3) + 3*qd1^2*sin(2*q2 + q3) + 4*qd1^2*sin(2*q2) + 8*g*cos(q2) + 6*qdd2*cos(q3) + 6*qdd3*cos(q3) - 12*qd2*qd3*sin(q3)))/(3*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -(4*qd1^2*sin(2*q2 + 2*q3)*(8*qdd2 - 3*qd1^2*sin(q3) - 6*qd2^2*sin(q3) - 6*qd3^2*sin(q3) + 3*qd1^2*sin(2*q2 + q3) + 4*qd1^2*sin(2*q2) + 8*g*cos(q2) + 6*qdd2*cos(q3) + 6*qdd3*cos(q3) - 12*qd2*qd3*sin(q3)))/(3*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -(8*(qdd2 + qdd3)*(8*qdd2 - 3*qd1^2*sin(q3) - 6*qd2^2*sin(q3) - 6*qd3^2*sin(q3) + 3*qd1^2*sin(2*q2 + q3) + 4*qd1^2*sin(2*q2) + 8*g*cos(q2) + 6*qdd2*cos(q3) + 6*qdd3*cos(q3) - 12*qd2*qd3*sin(q3)))/(3*(sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -(150*qdd3*(50*qdd2 + 18*qdd3 - 24*qd3^2*sin(q3) + 24*qd1^2*sin(2*q2 + q3) + 24*g*cos(q2 + q3) + 16*qd1^2*sin(2*q2) + 32*g*cos(q2) + 9*qd1^2*sin(2*q2 + 2*q3) + 48*qdd2*cos(q3) + 24*qdd3*cos(q3) - 48*qd2*qd3*sin(q3)))/((sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -(150*qd3*(50*qdd2 + 18*qdd3 - 24*qd3^2*sin(q3) + 24*qd1^2*sin(2*q2 + q3) + 24*g*cos(q2 + q3) + 16*qd1^2*sin(2*q2) + 32*g*cos(q2) + 9*qd1^2*sin(2*q2 + 2*q3) + 48*qdd2*cos(q3) + 24*qdd3*cos(q3) - 48*qd2*qd3*sin(q3)))/((sin(2*q2)*qd1^2 + 2*qdd2 + 2*g*cos(q2))*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3)));...
%        0,    0,               0, 0,                                                                                                   0,                                                                                                  0,                                                                                                                                                                                                                   0,                                                                                                                 0,                                                                                                     0,                                                                                                         0,                                                                                                        0, 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(8*(6*qdd2 + 6*qdd3 + 2*qd1^2*sin(q3) + 4*qd2^2*sin(q3) + 2*qd1^2*sin(2*q2 + q3) + 4*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 4*qdd2*cos(q3)))/(3*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (32*((sin(2*q2 + 2*q3)*qd1^2)/2 + qdd2 + qdd3))/(3*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -(16*qd1^2*sin(2*q2 + 2*q3))/(3*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (16*qd1^2*sin(2*q2 + 2*q3))/(3*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (32*(qdd2 + qdd3))/(3*(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (2400*qdd3)/(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (2400*qd3)/(6*qdd2 + 6*qdd3 + 4*qd1^2*sin(q3) + 8*qd2^2*sin(q3) + 4*qd1^2*sin(2*q2 + q3) + 8*g*cos(q2 + q3) + 3*qd1^2*sin(2*q2 + 2*q3) + 8*qdd2*cos(q3))];
%  
   
 

Sigma_red=[Iyy1+2500*Jm1+Iyy2-Izz2-900*Jm2+Iyy3-Izz3 ;Bm1 ;m2-m2*lc2^2-Izz2-900*Jm2+(16/9)*m3*lc3^2+(16/9)*Izz3;...
    m2*lc2-m2*lc2^2-Izz2-900*Jm2;Ixx2-Iyy2+Izz2+900*Jm2;Bm2;m3-(16/9)*m3*lc3^2-(16/9)*Izz3;...
    m3*lc3-(4/3)*m3*lc3^2-(4/3)*Izz3;Ixx3-Iyy3+Izz3;Jm3;Bm3];

Gamma_red= [  qdd1, 2500*qd1, 0.5*qdd1 + 0.5*qdd1*cos(2.0*q2) - 1.0*qd1*qd2*sin(2.0*q2), 2.0*qd1*qd2*sin(2.0*q2) - 1.0*qdd1*cos(2.0*q2) - 1.0*qdd1, qdd1/2 - 0.5*qdd1*cos(2.0*q2) + qd1*qd2*sin(2.0*q2),       0, 0.78125*qdd1 + 0.75*qdd1*cos(2.0*q2 + q3) + 0.28125*qdd1*cos(2*q2 + 2*q3) + 0.5*qdd1*cos(2.0*q2) + 0.75*qdd1*cos(q3) - 0.75*qd1*qd3*sin(q3) - 1.5*qd1*qd2*sin(2.0*q2 + q3) - 0.75*qd1*qd3*sin(2.0*q2 + q3) - 0.5625*qd1*qd2*sin(2*q2 + 2*q3) - 0.5625*qd1*qd3*sin(2*q2 + 2*q3) - 1.0*qd1*qd2*sin(2.0*q2), qd1*qd3*sin(q3) - 1.0*qdd1*cos(2.0*q2 + q3) - 0.75*qdd1*cos(2*q2 + 2*q3) - 1.0*qdd1*cos(q3) - 0.75*qdd1 + 2.0*qd1*qd2*sin(2.0*q2 + q3) + qd1*qd3*sin(2.0*q2 + q3) + 1.5*qd1*qd2*sin(2*q2 + 2*q3) + 1.5*qd1*qd3*sin(2*q2 + 2*q3),  qdd1/2 - 0.5*qdd1*cos(2*q2 + 2*q3) + qd1*qd2*sin(2*q2 + 2*q3) + qd1*qd3*sin(2*q2 + 2*q3),        0,       0;...
             0    ,        0,                  0.5*sin(2.0*q2)*qd1^2 + qdd2 + g*cos(q2),            - 1.0*sin(2.0*q2)*qd1^2 - 2.0*qdd2 - g*cos(q2),                              -0.5*qd1^2*sin(2.0*q2), 900*qd2,                                                                     1.5625*qdd2 + 0.5625*qdd3 - 0.75*qd3^2*sin(q3) + 0.75*g*cos(q2 + q3) + 0.75*qd1^2*sin(2.0*q2 + q3) + g*cos(q2) + 0.28125*qd1^2*sin(2*q2 + 2*q3) + 1.5*qdd2*cos(q3) + 0.75*qdd3*cos(q3) + 0.5*qd1^2*sin(2.0*q2) - 1.5*qd2*qd3*sin(q3),                                                 qd3^2*sin(q3) - 1.5*qdd3 - 1.5*qdd2 - 1.0*g*cos(q2 + q3) - 1.0*qd1^2*sin(2.0*q2 + q3) - 0.75*qd1^2*sin(2*q2 + 2*q3) - 2.0*qdd2*cos(q3) - 1.0*qdd3*cos(q3) + 2.0*qd2*qd3*sin(q3),                                                               -0.5*qd1^2*sin(2*q2 + 2*q3),        0,       0;...
             0    ,        0,                                                         0,                                                         0,                                                   0,       0,                                                                                                                           0.5625*qdd2 + 0.5625*qdd3 + 0.375*qd1^2*sin(q3) + 0.75*qd2^2*sin(q3) + 0.75*g*cos(q2 + q3) + 0.375*qd1^2*sin(2.0*q2 + q3) + 0.28125*qd1^2*sin(2*q2 + 2*q3) + 0.75*qdd2*cos(q3),                                                                - 1.5*qdd2 - 1.5*qdd3 - 0.5*qd1^2*sin(q3) - 1.0*qd2^2*sin(q3) - 1.0*g*cos(q2 + q3) - 0.5*qd1^2*sin(2.0*q2 + q3) - 0.75*qd1^2*sin(2*q2 + 2*q3) - 1.0*qdd2*cos(q3),                                                               -0.5*qd1^2*sin(2*q2 + 2*q3), 225*qdd3, 225*qd3];
 
simplify(Gamma*Sigma - Gamma_red*Sigma_red)